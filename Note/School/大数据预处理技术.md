# 从数据处理开始

## 数据理解

- 机器学习的任务是：回归、分类和无监督学习
- 监督学习是使用已知的训练样本，而非监督学习直接使用数据进行建模分析
- 数据挖掘的六大任务是：分类、聚类、回归、关联、序列和异常检测

## 单变量数据探索

每次只分析1个变量,单变量数据探索主要目的是对单个变量的数据分布进行查看，方便后续的数据预处理

常见的单变量分析方法有：
- 频数分析：分析类别型变量每个值出现的频数，还可以通过饼图或柱状图可视化展现
- 描述性统计：对数值型变量的常用统计量进行分析
- 直方图：对数值型变量进行分段处理后进行频数分析并作图

## 多变量数据探索

不是一次性探索多个单变量，而是同时探索多个变量之间的相关关系

两个变量之间的相关性分析方法：
- 两个数值型变量：散点图
- 两个类别型变量：交叉表、堆栈条图
- 一个数值型一个类别型变量：分类汇总统计

## 数据预处理

主要目的是为机器学习建模进行数据准备，常做的数据预处理工作有：
- 对缺失值的处理
- 对类别型变量的值进行重新编码
- 把连续性变量进行分箱，然后再按照处理类别型变量的方式重新编码
- 对连续性变量进行标准化和归一化处理

### 缺失值处理

1. 直接把有缺失值的整条记录删除，适合数据样本较大而缺失记录较少的场景，删除缺失记录对整体影响很小
2. 构造一个新变量来标记缺失值：缺失标记为1，不缺失标记为0，适合缺失值本身是一个有意义的信息
3. 用一个值替换掉缺失值

### 类别变量重新编码

机器学习算法要求输入的变量值必须是数值

针对类别型变量必须重新编码，转换为数值型变量，信息量还不会丢失。最常用的一种类别变量编码方式是哑变量编码，也叫独热编码

独热编码就是把1个类别型变量转化为N个0/1标识变量，类别型变量有多少个类别值，转化后就有多少个0/1标识变量

### 连续变量分箱

分箱可以让连续型变量变成类别型变量，直接做频数分析或者直方图，便于分析

变量分箱让模型变得更稳健，不太容易过拟合

- 自定义分箱
- 等宽分箱：每个箱的边界呈等差数列
- 等深分箱：保证每个箱内记录数一样或满足指定的比例

### 标准化和归一化

标准化和归一化都属于对变量进行无量纲化处理

无量纲化处理的作用：
- 让不属于同一量纲的特征值可以比较
- 无量纲化后模型收敛会加快，即运行速度变快
- 对一些模型的结果影响较大，一般是涉及到距离计算的模型和算法

## 特征变量的构造和组合

又称为特征工程

- 多个变量之间的数学运算
- 基于逻辑判断来构造衍生变量
- 多个特征变量进行组合

# 特征工程之数据预处理

## 非数值类型数据处理

### 哑变量处理

哑变量也叫虚拟变量，构造取值为0或1的变量，将类型变量换成数字1和0，使用get_dummies()函数进行哑变量处理

因为存在多重共线性(即通过n-1个变量可判断1个变量的值为0还是1)，所以要删去一个哑变量

### 编号处理

## 重复值、缺失值及异常值处理

### 重复值处理

使用duplicated()函数来查询重复的内容

使用sum()函数统计重复行的数量

使用drop_duplicates()函数删除重复行

### 缺失值处理

使用isnull()函数或isna()函数来查看空值，是空值则为True，否则为False

使用dropna()函数可以删除空值，设置thresh参数为n，则删除非空值少于n个的行

使用fillna()可以填补空值，method = 'pad'代表用缺失值所在列的前一个值填充，若前一个值也缺失，则结果不变，method = 'backfill'使用后一个值，limit参数可以限制每列能替换的缺失值个数

### 异常值处理

主要通过箱型图观察和标准差检测异常值

使用boxplot()函数可以绘制箱型图

异常值常见处理方式有：
1. 删除含有异常值的记录
2. 视为缺失值，使用缺失值处理的方法进行处理
3. 使用数据分析来进行异常值处理
4. 如果异常值较少或影响不大也可以不处理

## 数据分箱

使用cut()函数进行分箱

## 特征筛选：WOE值与IV值

### WOE值

WOE的全称是证据权重，要计算一个变量的WOE值，需要首先将变量进行分箱处理，分箱后，对于第i组分箱内的数据，该分箱的WOE值使用WOE值的计算公式计算：  
- WOEi = ln(pyi/pni)
- pyi = yi/yT    pni = ni/nT

pyi是第i组分箱中目标变量标签取值为1的个体占整个数据中1的比例  
pni是第i组分箱中目标变量标签取值为0的个体占整个数据中0的比例  
yi是第i组分箱中1的个体数量  
yT是整个样本中所有1的个体数量
ni是第i组分箱中0的个体数量  
nT是整个样本中所有0的个体数量

### IV值

IV值能较好的反应特征变量的预测能力，特征变量对于预测结果的贡献越大，IV值越大，IV值的计算公式：  
- IVi = (pyi - pni) × WOEi
- IV = ∑IVi
