# 第一章 绪论

## 数据库系统概述

### 数据库的4个基本概念

#### 数据

数据是数据库中存储的基本对象

#### 数据库(DB)

数据库是长期储存在计算机内、由组织的、可共享的大量数据的集合

基本特征：
- 数据按一定的数据模型组织、描述和储存
- 可为各种用户共享
- 冗余度较小
- 数据独立性较高
- 易扩展

#### 数据库管理系统(DBMS)

操纵和管理数据库的大型软件，用于建立、使用和维护数据库

主要功能：
- 数据定义：提供数据定义语言(DDL)
- 数据组织、存储和管理
- 数据操纵：提供数据操纵语言(DML)
- 数据库的事务管理和运行
- 数据库的建立和维护
- 其他功能

#### 数据库系统(DBS)

数据库系统的构成：
- 用户
- 数据库
- 数据库管理系统
- 应用系统
- 数据库管理员

### 数据管理技术的产生和发展

数据管理：对数据进行分类、组织、编码、存储、检索和维护

### 数据库系统的特点

- 数据结构化
- 数据的共享性高、冗余度低且一扩充
- 数据独立性高
- 数据由数据库管理系统统一管理和控制

## 数据模型

数据模型就是现实世界的模拟

数据模型应满足：
- 比较真实的模拟现实世界
- 容易为人所理解
- 便于在计算机上实现

数据模型是数据库系统的核心和基础

### 两类数据模型

数据模型分为两类(两个不同的层次，三个模型)
- 概念模型（也称信息模型），按用户的观点来对数据和信息建模，用于数据库设计
- 逻辑模型（也称数据模型）和物理模型
    - 逻辑模型主要包括网状模型、关系模型等，按计算机系统的观点对数据建模，用于DBMS实现
    - 物理模型是对数据最底层的抽象，描述数据在系统内部的表示方法和存取方法

客观对象的抽象过程
- 现实世界中的客观对象抽象为概念模型
- 概念模型转换为某一数据库管理系统支持的数据模型

### 概念模型

#### 实体联系方法

用E-R图来描述现实世界的概念模型

E-R方法也称为E-R模型

### 数据模型的组成要素

- 数据结构
- 数据操作
- 数据的完整性约束条件

### 常用的数据模型

- 层次模型
- 网状模型
- 关系模型
- 面向对象数据模型
- 对象关系数据模型
- 半结构化数据模型

### 层次模型

数据库系统中最早出现的数据模型

层次模型用**树状结构**来表示各类实体以及实体间的联系

### 网状模型

### 关系模型

在用户观点下，每个关系的数据结构是一张二维表，由行和列组成

#### 数据结构
- 关系：一个关系通常对应一个表
- 元组：表中的一行即为一个元组
- 属性：表中的一列即为一个属性
- 主码：也称码键，可以唯一确定一个元组
- 域：一组具有相同数据类型的值的集合
- 分量：元组中的一个属性值
- 关系模式：对关系的描述

## 数据库系统的结构

从数据库应用开发人员角度看，数据库系统通常采用三级模式结构，是数据库系统内部的系统结构

从数据库用户角度看，数据库系统的结构分为：
- 单用户结构
- 主从式结构
- 分布式结构
- 客户-服务器
- 浏览器-应用服务器/数据库服务器多层结构

### 数据库系统模式的概念

- 型(Type)：对某一类数据的结构和属性的说明
- 值(Value)：是型的一个具体赋值
- 模式：是型的描述，不涉及具体值
- 实例：模式的一个具体值

### 数据库系统的的三级模式结构

#### 模式（也称逻辑模式）

数据库中全体数据的逻辑结构和特征的描述

一个数据库只有一个模式，是数据库系统模式结构的中间层

#### 外模式（也称子模式或用户模式）

数据库用户使用的局部数据的逻辑结构和特征的描述

介于模式与应用之间

#### 内模式（也称存储模式）

是数据物理结构和存储方式的描述

一个数据库只有一个内模式

### 数据库的二级映像功能与数据独立性

三级模式是对数据的三个抽象级别

二级映像在数据库管理系统内部实现这三个抽象层次的联系与转换

#### 外模式/模式映像

每一个外模式，数据库系统都有一个外模式/模式映像，定义外模式与模式之间的对应关系

映像通常包含在各自外模式的描述中，保证数据的逻辑独立性

#### 模式/内模式映像

定义了数据全局逻辑结构与存储结构之间的对应关系

模式/内模式映像是唯一的，该映像定义通常包含在模式描述中，保证数据的物理独立性

## 数据库系统的组成

- 数据库
- 数据库管理系统
- 应用程序
- 数据库管理员
- 硬件平台及数据库
- 软件
- 人员

# 第二章 关系数据库

## 关系数据结构及形式化定义

### 关系

单一的数据结构->关系  
逻辑结构->二维表  

#### 域

一组具有相同数据类型的值的集合

#### 笛卡尔积

所有域的所有取值的一个组合，不能重复

- 元组：笛卡尔积中每一个元组叫做一个n元组，或简称为元组
- 分量：笛卡尔积元素中的每一个值叫做一个分量
- 基数：即行数，若Di为有限集，其基数为mi,的D1 * D2 * ... * Dn的基数M为：m1 * m2 * ... * mn
- 目数：即列数，相加得出

### 关系模式

#### 什么是关系模式

关系是值，关系模式是型，关系模式是对关系的描述

#### 定义关系模式

可形式化的表示为：R(U, D, DOM, F)
R表示关系名，U表示组成该关系的属性名集合， D表示属性组U中属性所来自的域， DOM表示属性向域的映像合计，F表示属性间的数据依赖关系集合

#### 关系模式与关系

- 关系模式：对关系的描述，静态的、稳定的
- 关系：关系模式在某一时刻的状态或内容，动态的、随时间变化的

关系模式和关系往往统称为关系

## 关系操作

### 基本关系操作

常用的关系操作：
- 查询：选择、投影、连接、除、并、交、差
- 数据更新：插入、删除、修改

选择、投影、并、差、笛卡尔积是5种基本操作

关系操作的特点：集合操作方式

### 关系数据库语言的分类

- 关系代数语言
- 关系演算语言
- 具有关系代数和关系演算双重特点的语言

## 关系完整性

### 关系的三类完整性约束

- 实体完整性和参照完整性：关系模型必须满足的完整性约束条件，称为关系的两个不变形
- 用户定义的完整性

### 实体完整性

若属性A是基本关系R的主属性，则属性A不能取空值

### 参照完整性

#### 外码

F是基本关系R的一个或一组属性，但不是关系R的码。如果F与基本关系S的主码K相对应，则称F是基本关系R的外码

基本关系R称为参照关系，基本关系R称为被参照关系或目标关系

#### 参照完整性规则

若F是基本关系R的外码，与基本关系S的主码K对应，则F的取值必须为空值或S中某个元组的主码值

### 用户定义的完整性

针对某一具体关系数据库的约束条件

## 关系代数

用到的运算符包括两类，集合运算符和专门的关系运算符

### 传统的集合运算

#### 并

对于关系R和S，两个关系应该具有相同的目n,相同的属性应该取自同一个域

并的结果仍为n目关系

#### 差

同并

#### 交

同并

#### 笛卡尔积

### 专门的关系运算

#### 选择

又称限制

在关系R中选择满足给定条件的诸元组

#### 投影

从R中选择出若干属性列组成新的关系

#### 连接

从两个关系的笛卡尔积中选取属性间满足一定条件的元组

- 等值连接：从关系R与S的广义笛卡尔积中选取A、B属性值相等的那些元组
- 自然连接：一种特殊的等值连接，在结果中把重复的属性列去掉
- 外连接：把舍弃的元组也保留在结果关系中，在其他属性上填空值
    - 左外连接：只把左边关系中要舍弃的元组保留
    - 右外连接：只把右边关系中要舍弃的元组保留

#### 除

# 关系数据库标准语言SQL

## SQL概述

结构化查询语言，是关系数据库的标准语言

### SQL的特点

- 综合统一：
    
    集数据定义语言(DDL)，数据操纵语言(DML)，数据控制语言(DCL)为一体，可以独立完成数据库生命周期中的全部活动

- 高度非过程化：

    只需要提出做什么，无须了解存取路径

- 面向集合的操作方式

- 以同一种语法结构提供多种使用方式

- 语言简洁，易学易用

### SQL的基本概念

支持关系数据库三级模式结构

## 数据定义

SQL的数据定义功能：模式定义、表定义、视图和索引的定义

### 模式的定义与删除

- 定义：create schema <模式名> authorization <用户名>
- 删除：drop schema <模式名> <cascade|restrict>
    - cascade 级联：删除模式的同时把该模式中所有的数据库对象全部删除
    - restrict 限制：仅当该模式中没有任何下属的对象时才能执行

### 基本表的定义、删除与修改

#### 定义

create table <表名>
    (<列名> <数据类型> [<列级完整性约束条件>]  
    ...  
    <表级完整性约束条件>);

#### 修改

alter table <表名>  
...

#### 删除

drop table <表名> [restrict|cascade]

- restrict：删除表是有限制的，如果存在依赖该表的对象，则表不能被删除
- cascade：删除表没有限制，相关的依赖对象一起删除

### 索引的建立与删除

#### 建立

create [unique|cluster] index <索引名>  
on <表名> (<列名> <次序>, ...)

#### 修改

alter index <旧索引名> rename to <新索引名>

#### 删除

drop index <索引名>

### 数据字典

是关系数据库管理系统内部的一组系统表，记录了数据库中所有定义信息

## 数据查询

select <目标列表达式>  
from <表名或视图名> as <别名>  
where <条件表达式>  
group by <列名>  
having <条件表达式>  
order by <列名> [asc|desc]