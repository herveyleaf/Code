# 最优化基础

## 最优化问题的分类与实际应用

- 若可行域D = R^n，即x是自由变量，则优化问题为无约束优化问题，否则为约束优化问题

- 若目标函数和约束函数都是线性的，则问题为线性规划，若目标函数和约束函数中至少有一个是非线性的，则为非线性规划，若目标函数是二次函数、约束函数是线性函数，则为二次规划

- 若可行域内点的个数是有限的，则优化问题为离散最优化问题，若含有无穷多个点且可行域内的点可以连续变化，则为连续最优化问题

- 若目标函数为向量函数，则为多目标规划问题，若为数量函数，则为单目标规划问题

## 多元函数分析

一阶导数称为梯度，是列向量，写成行向量转置的形式，n元函数f(x)依次对x求导

二阶导数称为Hesse矩阵，为一阶导数依次对x求导得出

向量函数F(x) = (f1(x), f2(x), ..., fm(x))^T的各个分量函数fi(x)对自变量各分量的偏导数称为Jacobi矩阵，每一行由向量函数的分量函数决定，每一列由自变量的分量决定

函数f(x)在X除沿方向d的一阶方向导数为f(x)在X处的一阶导数与方向d / ||d||的内积，其中d也是列向量

方向导数若大于零，则在此处沿该方向增加时函数值上升，若小于零，则在此处沿该方向下降。特别的，当方向d = X处的一阶导数时，方向导数最大，d为最速上升方向

## 凸集与凸函数

凸集的几何意义是：若两点属于此集合，则这两点连线上的任意一点均属于此集合

D是凸集的充要条件是：对于任意的m≥2，任给m个x属于D，m个实数a且任意a≥0，均有∑aixi属于D

若函数f(x)二阶可微，则有：f(x)的Hesse矩阵在D上是半正定的，那么f(x)是D上的凸函数；若Hesse矩阵是正定的，则是严格凸函数，反之f(x)是严格凸函数，Hesse矩阵是半正定的

### 判定矩阵正定

若矩阵A的所有特征值均为正数，则A是正定的

若A的各阶顺序主子式均大于零，则A是正定的

若A的所有特征值均不小于零，则A是半正定的

若A的所有主子式非负，则A是半正定的，而不只是顺序主子式非负

特征值的求法为：解|λE - A| = 0，λ为特征值

# 无约束最优化方法的一般结构

## 最优性条件

无约束最优化问题的解有局部解和全局解两种，又分为局部解和严格局部解、全局解和严格全局解

- 一阶必要条件：若X是无约束问题的一个局部解，则在该点的梯度等于零
- 二阶必要条件：若f(x)二阶连续可微，X是一个局部解，则该点的梯度等于零且Hesse矩阵为半正定
- 二阶充分条件：若f(x)二阶连续可微，且X处的梯度等于零，Hesse矩阵正定，则X是一个严格局部解

满足梯度为零的点称为函数f的平稳点或驻点，既不是极大点也不是极小点的平稳点称为鞍点

## 线性搜索

### 精确线性搜索

满足Φ(ak) = min{Φ(a) = f(x^k + ad^k)}的ak为最优步长，ak是Φ(a)导数等于零的非负根

求Φ(a)的全局极小点很困难，一般取方程的最小正根作为Φ(a)的极小点ak，这叫做Curry准则

### 0.618法

在搜索区间(a, b)上确定两个试探点，左试探点al = a + 0.382 * (b - a)，右试探点ar = a + 0.618 * (b - a)，精度为ε

若左试探点的函数值小于右试探点的函数值，则右试探点到b这个区间不可能有极小点，令(a, ar)成为新的搜索区间；反之，若右试探点的函数值小于左试探点的函数值，则a到左试探点这个区间不可能有极小点，令(al, b)成为新的搜索区间

每次更新，上一次的右试探点为新区间的左试探点，上一次的左试探点为新区间的右试探点

当|b - a| ≤ ε时，取函数值小的试探点作为问题的解

## 下降算法的全局收敛性与收敛速度

下降算法一般的迭代格式是：

1. 给定初始点x1，k = 1
2. 确定局部下降方向dk，令f(xk)的梯度与下降方向dk的内积小于0
3. 确定步长ak大于0，令f(xk + akdk) < f(xk)
4. 令xk+1 = xk + akdk
5. 若xk+1满足终止准则，则停止，否则继续迭代

对于只有当初始点x1靠近极小点X时，才能保证序列{xk}收敛到X，则称这类算法为局部收敛，反之，对于任意的初始点x1，序列{xk}都收敛到X，则称这类算法为全局收敛

设序列{xk}收敛到X，若极限lim (||xk+1 - X||) / (||xk - X||) = β

当0 < β < 1时，称{xk}为线性收敛，当β = 0时，为超线性收敛，当β = 1时，为次线性收敛

若存在p ≥ 1，lim (||xk+1 - X||) / (||xk - X||)^p = β < +∞

则称{xk}为p阶收敛

可以用二次终止性来判定算法优劣

# 无约束规划方法

## 最速下降法

1. 选定初始点x1并给定精度要求ε > 0，令k = 1
2. 若f(xk)的梯度的模小于ε则停，令最优解X = xk，否则令搜索方向dk = 负的f(xk)的梯度
3. 在xk处沿方向dk作线性搜索，得xk+1 = xk + akdk，重复步骤2

线性搜索方法使用精确线性搜索，即求解f(xk + adk) / da = 0得出步长a

## Newton法

1. 选定初始点x1并给定精度要求ε，令k = 1
2. 若f(xk)的梯度的模小于ε则停，令最优解X = xk，否则解方程组f(xk)的Hesse矩阵乘搜索方向d = 负的f(xk)的梯度，得出搜索方向dk
3. 令xk+1 = xk + dk，重复步骤2

牛顿法求解无约束问题会出现以下三种情况：
1. 收敛到极小点
2. 收敛到鞍点
3. Hesse矩阵奇异，无法继续计算

## 共轭梯度法

1. 选定初始点x1并给定精度要求ε，令k = 1
2. 若f(xk)的梯度的模小于ε则停，令最优解X = xk，否则令搜索方向dk = 负的f(x)的梯度加上βk-1dk-1  
其中当k = 1时，β0等于0，当k > 1时，βk-1等于(||f(xk)的梯度||^2) / (||f(xk-1)的梯度||^2)
3. 步长ak = -(dk^T乘f(xk)的梯度) / dk^T*G*dk，其中G为f(xk)的Hesse矩阵
4. 令xk+1 = xk + akdk

共轭梯度法具有以下性质：
1. 产生的搜索方向是下降方向
2. 不用计算Hesse矩阵，只计算目标函数值和梯度
3. 具有二次终止性

# 约束规划的最优性条件

## 基本概念

约束最优化问题的解有局部解和全局解两种，又分为局部解和严格局部解、全局解和严格全局解

## 约束规划问题局部解的必要条件

FD*为X处的可行方向集

对于不等式约束，当不等式取0时，则称该约束为有效约束，反之称为非有效约束，有效约束的集合称为有效约束指标集，简称为有效集

LD*为X处满足所有约束条件的方向的集合，LD∪{0}是一个锥，称为X处的线性化锥

FD是LD的子集，在某些条件下，LD = FD，任何一个保证LD = FD成立的条件称为约束限制条件

DD*是X处的下降方向的集合

若X是约束规划问题的局部解，则FD ∩ DD不为空

### 约束规划问题局部解的一阶必要条件

若X是约束问题的局部解，且X处的约束限制条件成立，则在X处满足KT条件

满足KT条件的不一定是局部解，局部解不一定满足KT条件，要约束限制条件成立才互相满足

### 约束限制条件

1. 约束条件均为线性函数
2. 约束条件的梯度线性无关

## 二阶充分条件

### 约束问题局部解的二阶充分条件

若存在X满足下列条件：
1. KT条件成立，且λi和ci(x)不同时为零(严格松弛互补条件)
2. 对于任意的d∈M，有d^T乘拉格朗日函数对x的求导的Hesse矩阵乘d大于0，其中M满足约束条件的梯度^T乘d等于0，约束条件是等式约束条件和有效约束

则X是约束问题的严格局部解

## 凸规划的最优性条件

对于非线性规划，若目标函数为凸函数，可行域D是凸集，则非线性规划为凸规划；如果非线性规划中只含不等式约束，且约束条件是凸函数，则D为凸集；对于混合约束问题，等式约束条件是线性函数，不等式条件为凸函数，则D是凸集

凸规划的局部解一定是全局解；若凸规划的可行点X是KT点，则X必是全局解

# 约束规划的对偶理论

## Lagrange对偶问题

约束规划问题的限制条件加上x∈X

集合X通常是由简单约束条件所定义的集合

Lagrange对偶函数d(λ)通常称为对偶子问题，满足d(λ)是原问题最优值的下界

所以Lagrange对偶问题的形式是：

max d(λ);
s.t. λi ≥ 0, i ∈ I

解题方法是写出Lagrange函数后，将式子变形，写成各个xi合并加上关于λi的常数项，求该式子的最小值，即为对偶问题的最大化下界d(λ)，限制条件隐含着λi ≥ 0

## 对偶定理

### 弱对偶定理

若x是原问题的可行解，λ是其对偶问题的可行解，则f(x) ≥ d(λ)

由此可得，若存在f(x) = d(λ)，则x和λ分别是原问题和对偶问题的最优解

若原问题是无界的，则任意d(λ) = -∞；若对偶问题是无界的，则原问题不可行

### 强对偶定理

若原问题存在最优解，那么对偶问题也存在最优解且两个问题的最优值相等

原问题的最优值为v(P)，对偶问题的最优值为v(D)，则v(P) - v(D)称为对偶间隙

## 对偶问题的性质及求解

设X为非空紧致集，目标函数和约束函数是连续函数，则对偶函数d(λ)是凹函数

# 罚函数法

## 外罚函数法

是一类不可行点的方法，基本思想是：在求解无约束优化问题的时候，通过对不可行的迭代点施加惩罚，随着迭代点的进展，增大惩罚量，迫使迭代点逐步向可行域靠近，一旦迭代点成为一个可行点，即为所求的原问题的最优解

1. 仅存在等式约束时

    记P(x) = ∑|ci(x)|^β， β ≥ 1

    则有如下形式的外罚函数：P(x, σ) = f(x) + σP(x)

    一般取β为2，要使外罚函数P(x, σ)取到极小值，则σ应该趋近+∞

    解题方法是令外罚函数P(x, σ)对x的偏导数等于零，解方程求出关于σ的xi，再令σ趋于+∞，得到最优解

2. 仅存在不等式约束时

    记P(x) = ∑[max(0, ci(x))]^α， α ≥ 1

    则有如下形式的外罚函数：P(x, σ) = f(x) + σP(x)

    解题方法是对max(0, ci(x))进行分类讨论，然后按照等式约束的解析法进行求解

3. 即存在等式约束也存在不等式约束时

    记P(x) = ∑|ci(x)|^β + ∑[max(0, ci(x))]^α， β ≥ 1， α ≥ 1

外罚函数的具体算法是：

1. 给定初始点x0， 设精度ε > 0，c > 1为给定实数，
2. 以xk-1为初始点求解无约束优化问题P(x, σk)，得到最优解xk
3. 若P(xk) < ε，则xk作为原问题的最优解，否则继续迭代